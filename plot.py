import os, csv
import numpy as np

# data_list = []
# csv_file_loc = "D:\Downloads\\breakout_bqfd"
# stop = 91000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)

# data_list = []
# csv_file_loc = "D:\Downloads\\breakout_dqfd"
# stop = 91000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)

# data_list = []
# csv_file_loc = "D:\Downloads\\breakout_dqn"
# stop = 91000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)












# data_list = []
# csv_file_loc = "D:\Downloads\\chopper_bqfd"
# stop = 63000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)

# data_list = []
# csv_file_loc = "D:\Downloads\\chopper_dqfd"
# stop = 63000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)

# data_list = []
# csv_file_loc = "D:\Downloads\\chopper_dqn"
# stop = 63000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)







# data_list = []
# csv_file_loc = "D:\Downloads\\freeway_bqfd"
# stop = 23000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)

# data_list = []
# csv_file_loc = "D:\Downloads\\freeway_dqfd"
# stop = 23000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)

# data_list = []
# csv_file_loc = "D:\Downloads\\freeway_dqn"
# stop = 23000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)

















# data_list = []
# csv_file_loc = "D:\Downloads\\seaquest_bqfd"
# stop = 96000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)

# data_list = []
# csv_file_loc = "D:\Downloads\\seaquest_dqfd"
# stop = 96000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)

# data_list = []
# csv_file_loc = "D:\Downloads\\seaquest_dqn"
# stop = 96000000
# for file_name in os.listdir(csv_file_loc):
#     if "npy" not in file_name:
#         data = open(csv_file_loc + "/" + file_name, "r")
#         data_list.append(csv.reader(data, delimiter=','))

# timesteps = []
# values = []
# for csv_reader in data_list:
#     skip = True
#     count = 0
#     for row in csv_reader:
#         if skip:
#             skip = False
#             continue
#         if int(row[1]) > stop:
#             break
#         timesteps.append(int(row[1]))
#         values.append(float(row[2]))
#         count += 1

# timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
# timesteps = np.expand_dims(timesteps, axis=1)
# values = np.expand_dims(values, axis=1)

# result = np.concatenate([timesteps, values], axis=1)
# np.save(csv_file_loc + "\\" + "aggregate.npy", result)

data_list = []
csv_file_loc = "D:\Downloads\\pos_dqn"
stop = 96000000
for file_name in os.listdir(csv_file_loc):
    if "npy" not in file_name:
        data = open(csv_file_loc + "/" + file_name, "r")
        data_list.append(csv.reader(data, delimiter=','))

timesteps = []
values = []
for csv_reader in data_list:
    skip = True
    count = 0
    for row in csv_reader:
        if skip:
            skip = False
            continue
        if int(row[1]) > stop:
            break
        timesteps.append(int(row[1]))
        values.append(float(row[2]))
        count += 1

timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
timesteps = np.expand_dims(timesteps, axis=1)
values = np.expand_dims(values, axis=1)

result = np.concatenate([timesteps, values], axis=1)
np.save(csv_file_loc + "\\" + "aggregate.npy", result)

data_list = []
csv_file_loc = "D:\Downloads\\pos_dqfd"
stop = 96000000
for file_name in os.listdir(csv_file_loc):
    if "npy" not in file_name:
        data = open(csv_file_loc + "/" + file_name, "r")
        data_list.append(csv.reader(data, delimiter=','))

timesteps = []
values = []
for csv_reader in data_list:
    skip = True
    count = 0
    for row in csv_reader:
        if skip:
            skip = False
            continue
        if int(row[1]) > stop:
            break
        timesteps.append(int(row[1]))
        values.append(float(row[2]))
        count += 1

timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
timesteps = np.expand_dims(timesteps, axis=1)
values = np.expand_dims(values, axis=1)

result = np.concatenate([timesteps, values], axis=1)
np.save(csv_file_loc + "\\" + "aggregate.npy", result)

data_list = []
csv_file_loc = "D:\Downloads\\pos_bqfd"
stop = 96000000
for file_name in os.listdir(csv_file_loc):
    if "npy" not in file_name:
        data = open(csv_file_loc + "/" + file_name, "r")
        data_list.append(csv.reader(data, delimiter=','))

timesteps = []
values = []
for csv_reader in data_list:
    skip = True
    count = 0
    for row in csv_reader:
        if skip:
            skip = False
            continue
        if int(row[1]) > stop:
            break
        timesteps.append(int(row[1]))
        values.append(float(row[2]))
        count += 1

timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
timesteps = np.expand_dims(timesteps, axis=1)
values = np.expand_dims(values, axis=1)

result = np.concatenate([timesteps, values], axis=1)
np.save(csv_file_loc + "\\" + "aggregate.npy", result)












data_list = []
csv_file_loc = "D:\Downloads\\neg_dqn"
stop = 96000000
for file_name in os.listdir(csv_file_loc):
    if "npy" not in file_name:
        data = open(csv_file_loc + "/" + file_name, "r")
        data_list.append(csv.reader(data, delimiter=','))

timesteps = []
values = []
for csv_reader in data_list:
    skip = True
    count = 0
    for row in csv_reader:
        if skip:
            skip = False
            continue
        if int(row[1]) > stop:
            break
        timesteps.append(int(row[1]))
        values.append(float(row[2]))
        count += 1

timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
timesteps = np.expand_dims(timesteps, axis=1)
values = np.expand_dims(values, axis=1)

result = np.concatenate([timesteps, values], axis=1)
np.save(csv_file_loc + "\\" + "aggregate.npy", result)

data_list = []
csv_file_loc = "D:\Downloads\\neg_dqfd"
stop = 96000000
for file_name in os.listdir(csv_file_loc):
    if "npy" not in file_name:
        data = open(csv_file_loc + "/" + file_name, "r")
        data_list.append(csv.reader(data, delimiter=','))

timesteps = []
values = []
for csv_reader in data_list:
    skip = True
    count = 0
    for row in csv_reader:
        if skip:
            skip = False
            continue
        if int(row[1]) > stop:
            break
        timesteps.append(int(row[1]))
        values.append(float(row[2]))
        count += 1

timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
timesteps = np.expand_dims(timesteps, axis=1)
values = np.expand_dims(values, axis=1)

result = np.concatenate([timesteps, values], axis=1)
np.save(csv_file_loc + "\\" + "aggregate.npy", result)

data_list = []
csv_file_loc = "D:\Downloads\\neg_bqfd"
stop = 96000000
for file_name in os.listdir(csv_file_loc):
    if "npy" not in file_name:
        data = open(csv_file_loc + "/" + file_name, "r")
        data_list.append(csv.reader(data, delimiter=','))

timesteps = []
values = []
for csv_reader in data_list:
    skip = True
    count = 0
    for row in csv_reader:
        if skip:
            skip = False
            continue
        if int(row[1]) > stop:
            break
        timesteps.append(int(row[1]))
        values.append(float(row[2]))
        count += 1

timesteps, values = (list(t) for t in zip(*sorted(zip(timesteps, values))))
timesteps = np.expand_dims(timesteps, axis=1)
values = np.expand_dims(values, axis=1)

result = np.concatenate([timesteps, values], axis=1)
np.save(csv_file_loc + "\\" + "aggregate.npy", result)

